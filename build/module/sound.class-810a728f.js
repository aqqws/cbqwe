var t=.1,e='function'==typeof Float32Array;function i(t,e){return 1-3*e+3*t}function s(t,e){return 3*e-6*t}function n(t){return 3*t}function r(t,e,r){return((i(e,r)*t+s(e,r))*t+n(e))*t}function o(t,e,r){return 3*i(e,r)*t*t+2*s(e,r)*t+n(e)}function a(t){return t}var l=function(i,s,n,l){if(!(0<=i&&i<=1&&0<=n&&n<=1))throw new Error('bezier x values must be in [0, 1] range');if(i===s&&n===l)return a;for(var h=e?new Float32Array(11):new Array(11),u=0;u<11;++u)h[u]=r(u*t,i,n);function c(e){for(var s=0,a=1;10!==a&&h[a]<=e;++a)s+=t;--a;var l=s+(e-h[a])/(h[a+1]-h[a])*t,u=o(l,i,n);return u>=.001?function(t,e,i,s){for(var n=0;n<4;++n){var a=o(e,i,s);if(0===a)return e;e-=(r(e,i,s)-t)/a}return e}(e,l,i,n):0===u?l:function(t,e,i,s,n){var o,a,l=0;do{(o=r(a=e+(i-e)/2,s,n)-t)>0?i=a:e=a}while(Math.abs(o)>1e-7&&++l<10);return a}(e,s,s+t,i,n)}return function(t){return 0===t?0:1===t?1:r(c(t),s,l)}};let h='http://www.w3.org/2000/svg',u=0,c={},p=!1,f=null;function d(t,e,i,s,n,r){u++,this.num=u,this.htmlContainerId=t.toLowerCase(),this.htmlContainer=document.getElementById(t),this.fireColor=e,this.startX=i,this.startY=s,this.fwScale=void 0!==r?r:1,this.volume=void 0!==n?n:1,this.SVGcanvas=null,this.fwContainer=null,this.ascendingFireBall=null,this.sparks=null,this.fastExplosion=null,this.particles=null,this.shineColor=null,this.velX=0,this.velY=-100,this.gravity=40,this.timeBeforeExplosion=1500,this.ascendingFireBallRadius=14,this.firstExplosionRadius=45,this.numExplosionParticles=200,this.explosionParticleRadius=2.5,this.explosionVelocity=180,this.explosionDeceleration=.96,this.explosionParticlesMaxLifespan=2e3,this.shineRadius=60,this.shineExpansionTime=800,this.shineFadeOutTime=1100,this.useAudio=!1,this.audioURL='Explosion.mp3',this.separation=118,this.fwCenter=132}function m(t,e,i,s,n,r,o,a){var l=void 0!==r&&r,h=void 0!==o?o:1,u=void 0!==a?a:0;return setTimeout((()=>{let n=new d(t,e,i,s,h);n.useAudio=l,n.velX=u,n.start()}),n)}d.prototype.start=function(){c.hasOwnProperty(this.htmlContainerId)?c[this.htmlContainerId]=c[this.htmlContainerId]+1:c[this.htmlContainerId]=1,this.separation=Math.round(1.6*(this.shineRadius+this.ascendingFireBallRadius)),this.fwCenter=this.ascendingFireBallRadius+this.separation;var t=this.htmlContainer.getElementsByClassName('fwSVGcanvas');if(t.length>0)this.SVGcanvas=t[0];else{this.SVGcanvas=document.createElementNS(h,'svg'),this.SVGcanvas.setAttributeNS(null,'class','fwSVGcanvas'),this.SVGcanvas.setAttributeNS(null,'width',this.htmlContainer.offsetWidth),this.SVGcanvas.setAttributeNS(null,'height',this.htmlContainer.offsetHeight),this.SVGcanvas.setAttributeNS(null,'style','display:block; position:absolute');var e=getComputedStyle(this.htmlContainer,null).position.toLowerCase();if('absolute'==e||'fixed'==e||'relative'==e)this.SVGcanvas.style.top='0px',this.SVGcanvas.style.left='0px';else{var i=this.htmlContainer.getBoundingClientRect();this.SVGcanvas.style.top=i.top+'px',this.SVGcanvas.style.left=i.left+'px'}this.htmlContainer.appendChild(this.SVGcanvas)}this.fwContainer=document.createElementNS(h,'svg');var s=(this.separation+this.ascendingFireBallRadius)*this.fwScale;this.fwContainer.setAttributeNS(null,'x',this.startX-s),this.fwContainer.setAttributeNS(null,'y',this.startY-s),this.fwContainer.setAttributeNS(null,'width',2*this.separation*this.fwScale),this.fwContainer.setAttributeNS(null,'height',2*this.separation*this.fwScale);var n=2*this.separation;this.fwContainer.setAttributeNS(null,'viewBox','0 0 '+n+' '+n),this.SVGcanvas.appendChild(this.fwContainer),this.useAudio&&!p&&(f=this.audioURL,p=!0),this.createGradient(this.fwContainer,'bigFireGrad'+this.num,[{offset:'20%',style:'stop-color:#fff;stop-opacity:1'},{offset:'45%',style:'stop-color:#'+this.fireColor+';stop-opacity:0.6'},{offset:'100%',style:'stop-color:#'+this.fireColor+';stop-opacity:0'}]),this.createFilter(this.fwContainer,'sparklesGlow'+this.num,'FFFFFF',2),this.createGradient(this.fwContainer,'explosionGrad'+this.num,[{offset:'0%',style:'stop-color:#fff;stop-opacity:1'},{offset:'100%',style:'stop-color:#'+this.fireColor+';stop-opacity:0'}]),this.createFilter(this.fwContainer,'particlesGlow'+this.num,this.fireColor,4),this.createGradient(this.fwContainer,'backlightGrad'+this.num,[{offset:'20%',style:'stop-color:#'+this.fireColor+';stop-opacity:0.3'},{offset:'100%',style:'stop-color:#'+this.fireColor+';stop-opacity:0'}]),this.ascendingFireBall=this.createSVG('circle','bigFire',{cx:this.fwCenter,cy:this.fwCenter,r:this.ascendingFireBallRadius,stroke:'none',fill:'url(#bigFireGrad'+this.num+')'}),this.fwContainer.appendChild(this.ascendingFireBall);var r=this.timeBeforeExplosion+Math.max(this.explosionParticlesMaxLifespan,this.shineExpansionTime+this.shineFadeOutTime)+100;this.projectileTween(this.fwContainer,r,(function(){o.fwContainer.removeChild(o.particles),o.fwContainer.removeChild(o.shineColor),o.SVGcanvas.removeChild(o.fwContainer),c[o.htmlContainerId]=Math.max(0,c[o.htmlContainerId]-1),0==c[o.htmlContainerId]&&o.htmlContainer.removeChild(o.SVGcanvas)}),this.gravity,this.velX,this.velY);var o=this,a=!1,l=[[.85,85],[.6,30],[.85,120],[1,30]],u=0;!function t(){a||(o.setSVGscale(o.ascendingFireBall,l[u][0],o.fwCenter,o.fwCenter),setTimeout(t,l[u][1]),u=u==l.length-1?0:u+1)}(),this.sparks=document.createElementNS(h,'svg'),this.sparks.setAttributeNS(null,'filter','url(#sparklesGlow'+this.num+')'),this.sparks.setAttributeNS(null,'x',this.separation),this.sparks.setAttributeNS(null,'y',this.separation),this.fwContainer.appendChild(this.sparks);var m=setInterval((()=>{d.prototype.addSpark.call(o)}),5);setTimeout((function(){a=!0,o.fwContainer.removeChild(o.ascendingFireBall),clearInterval(m),o.explosion()}),this.timeBeforeExplosion)},d.prototype.createSVG=(t,e,i)=>{var s=document.createElementNS(h,t);for(var n in null!=e&&s.setAttributeNS(null,'id',e),i)s.setAttributeNS(null,n,i[n]);return s},d.prototype.createGradient=function(t,e,i){for(var s=this.createSVG('radialGradient',e,{cx:'50%',cy:'50%',r:'50%',fx:'50%',fy:'50%'}),n=0;n<i.length;n++){var r=i[n],o=document.createElementNS(h,'stop');for(var a in r)o.hasAttribute(a)||o.setAttribute(a,r[a]);s.appendChild(o)}this.insertDef(t,s)},d.prototype.createFilter=function(t,e,i,s){var n=parseInt(i,16),r=(n>>16&255)/255,o=(n>>8&255)/255,a=(255&n)/255,l=this.createSVG('filter',e,{}),h=this.createSVG('feColorMatrix',null,{type:'matrix',values:'0 0 0 '+r+' '+r+'  0 0 0 '+o+' '+o+'  0 0 0 '+a+' '+a+'  0 0 0 1 0'});l.appendChild(h);var u=this.createSVG('feGaussianBlur',null,{stdDeviation:s,result:'coloredBlur'});l.appendChild(u);var c=this.createSVG('feMerge',null,{}),p=this.createSVG('feMergeNode',null,{in:'coloredBlur'}),f=this.createSVG('feMergeNode',null,{in:'SourceGraphic'});c.appendChild(p),c.appendChild(f),l.appendChild(c),this.insertDef(t,l)},d.prototype.insertDef=(t,e)=>{(t.querySelector('defs')||t.insertBefore(document.createElementNS(h,'defs'),t.firstChild)).appendChild(e)},d.prototype.addSpark=function(){var t=400+800*Math.random(),e=this.velX+20*Math.random()-10,i=80*Math.random()+40,s=this.ascendingFireBallRadius+3*Math.random()-1.5,n=this.ascendingFireBallRadius+4*Math.random(),r=this.sparks,o=d.prototype.createCircle.call(this,r,s,n,1,'FFEEB8');this.projectileTween(o,t,(function(){r.removeChild(o)}),0,-e,i,1,0)},d.prototype.explosion=function(){var t=this;this.shineColor=this.createSVG('circle','shineColor',{cx:this.fwCenter,cy:this.fwCenter,r:this.shineRadius,stroke:'none',fill:'url(#backlightGrad'+this.num+')'}),this.fwContainer.appendChild(this.shineColor),this.fastExplosion=this.createSVG('circle','explosion',{cx:this.fwCenter,cy:this.fwCenter,r:this.firstExplosionRadius,stroke:'none',fill:'url(#explosionGrad'+this.num+')'}),this.fwContainer.appendChild(this.fastExplosion),this.animation(65,(function(e){e>15&&e<40&&t.setSVGscale(t.fastExplosion,1.67,t.fwCenter,t.fwCenter);e>=40&&e<65&&t.setSVGscale(t.fastExplosion,1,t.fwCenter,t.fwCenter)}),(()=>{t.fwContainer.removeChild(t.fastExplosion)})),this.particles=document.createElementNS(h,'svg'),this.particles.setAttributeNS(null,'filter','url(#particlesGlow'+this.num+')'),this.particles;for(var e=0;e<this.numExplosionParticles;e++){var i=Math.pow(Math.random(),.3)*this.explosionVelocity,s=2*Math.random()*Math.PI,n=i*Math.sin(s),r=i*Math.cos(s),o=50+Math.random()*this.explosionParticlesMaxLifespan,a=this.createCircle(this.particles,this.fwCenter,this.fwCenter,this.explosionParticleRadius,'FFFFFF',this.fireColor);this.explosionParticleTween(a,o,this.explosionParticleRadius,this.explosionDeceleration,n,r)}function l(e){var i=Math.min(e/t.shineFadeOutTime,1),s=1-i*i;t.shineColor.setAttribute('fill-opacity',s)}this.fwContainer.appendChild(this.particles),this.animation(this.shineExpansionTime,(function(e){var i=Math.min(e/t.shineExpansionTime,1),s=.9+i*(2-i)*.7;t.shineColor.setAttribute('r',s*t.shineRadius)}),(function(){t.animation(t.shineFadeOutTime,l,null)})),this.useAudio&&f.play(this.volume)},d.prototype.createCircle=(t,e,i,s,n,r)=>{r=void 0!==r?'#'+r:'none';var o=document.createElementNS(h,'circle');return o.setAttributeNS(null,'cx',e),o.setAttributeNS(null,'cy',i),o.setAttributeNS(null,'r',s),o.setAttributeNS(null,'fill','#'+n),o.setAttributeNS(null,'stroke',r),'none'!=r&&o.setAttributeNS(null,'stroke-width',.5),t.appendChild(o),o},d.prototype.projectileTween=function(t,e,i,s,n,r,o,a){var l=(o=void 0!==o?o:1)!=(a=void 0!==a?a:1),h=a-o,u=0,c=0,p='svg'!=t.nodeName;l&&(p?t.setAttribute('fill-opacity',o+''):t.style.opacity=o);var f=this;this.animation(e,(function(i){u=i-c,c=i;var a=u/1e3;r+=s*a;var d=p?'cx':'x',m=p?'cy':'y';if(f.increaseParameter(t,d,n*a),f.increaseParameter(t,m,r*a),l){var C=o+h*(i/e);p?t.setAttribute('fill-opacity',C):t.style.opacity=C}}),i)},d.prototype.explosionParticleTween=function(t,e,i,s,n,r){var o=this,a=0,l=0;this.animation(e,(function(h){a=h-l,l=h;var u=Math.pow(s,a/17);n*=u,r*=u;var c=a/1e3;o.increaseParameter(t,'cx',n*c),o.increaseParameter(t,'cy',r*c);var p=1-h/e*.9;p=Math.max(p,.01),t.setAttribute('r',p*i),t.setAttribute('stroke-width',.5*p)}),null)},d.prototype.animation=(t,e,i)=>{i=void 0!==i?i:null;var s=null;!function n(){var r=(new Date).getTime();null===s&&(s=r);var o=r-s;e(o),o<t?setTimeout(n,15):null!=i&&i()}()},d.prototype.increaseParameter=(t,e,i)=>{t.setAttribute(e,parseFloat(t.getAttribute(e))+i)},d.prototype.setSVGscale=(t,e,i,s)=>{t.setAttribute('transform','scale('+e+')'),t.setAttribute('cx',i+(1-e)*i/e),t.setAttribute('cy',s+(1-e)*s/e)},window.AudioContext=window.AudioContext||window.webkitAudioContext;const C=new AudioContext;class v{url='';mute=!1;buffer=null;volume=.2;sources=[];constructor(t){this.url=t}load(t){return this.volume=t||this.volume,this.url?this.buffer?Promise.resolve(this.buffer):new Promise(((t,e)=>{const i=new XMLHttpRequest;i.open('GET',this.url,!0),i.responseType='arraybuffer',i.onload=()=>{C.decodeAudioData(i.response,(i=>{i?(this.buffer=i,t(i)):e(new Error(`Sound decoding error: ${this.url}`))}))},i.onerror=t=>{e(t)},i.send()})):Promise.reject(new Error('Missing or invalid URL: ',this.url))}play(t=0){if(!this.buffer||this.mute)return;const e=C.createBufferSource();e.buffer=this.buffer;const i=this.sources.push(e)-1;e.onended=()=>{e.stop(0),this.sources.splice(i,1)};const s=C.createGain();s.gain.value=this.volume,e.connect(s).connect(C.destination),e.start(t)}stop(){this.sources.forEach((t=>{t.stop(0)})),this.sources=[]}}export{d as C,m as F,v as S,l as s};
